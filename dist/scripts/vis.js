!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var a=n[o]={exports:{},id:o,loaded:!1};return e[o].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}({0:function(e,t,n){e.exports=n(44)},44:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var a=n(45),r=o(a),i=n(47),s=o(i),c=n(50),u=o(c),l=n(51),d=o(l),m=function(e){e.children.forEach(function(t){t.name.includes("Dungeon")&&e.remove(t)})},E=function(e,t){var n=new THREE.Object3D;n.name="Dungeon_"+t;var o=new s["default"](e.rooms);o.frustumCulled=!1,n.add(o);var a=new u["default"](e.tunnels);a.frustumCulled=!1,n.add(a);new d["default"](e.mstLines,255),new d["default"](e.leftAliveLines,65280);return n};window.dungeonizer=window.dungeonizer||{},window.dungeonizer.initVisualizer=function(e){e.setClearColor(3359778,1);var t=e.getContext(),n=t.canvas.clientWidth/t.canvas.clientHeight,o=new THREE.PerspectiveCamera(60,n,.1,2e3);o.position.z=76,o.position.y=70,o.position.x=62,o.lookAt(new THREE.Vector3(0,0,0)),o.updateProjectionMatrix();var a=new r["default"](o,e.domElement),i=new THREE.Scene,s=new THREE.AmbientLight(2105376);i.add(s);var c=new THREE.DirectionalLight(7368816);c.position.set(10,20,10),i.add(c);var u=new THREE.DirectionalLight(7368816);return u.position.set(-30,20,10),i.add(u),{scene:i,update:function(){a.update(),e.render(i,o)},resize:function(e,t){n=e/t,o.aspect!==n&&(o.aspect=n,o.updateProjectionMatrix())},dispose:function(){a.dispose(),m(i)},makeDungeonVisual:function(e,t){m(i);var n=E(e,t);i.add(n)}}}},45:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();window.THREE=THREE,n(46);var r=function(){function e(t,n){o(this,e),this.orbitControls=new THREE.OrbitControls(t,n),this.orbitControls.enableDamping=!0,this.orbitControls.rotateSpeed=.25}return a(e,[{key:"update",value:function(){this.orbitControls.update()}},{key:"dispose",value:function(){this.orbitControls.dispose()}}]),e}();t["default"]=r},46:function(e,t){THREE.OrbitControls=function(e,t){function n(){return 2*Math.PI/60/60*N.autoRotateSpeed}function o(){return Math.pow(.95,N.zoomSpeed)}function a(e){z.theta-=e}function r(e){z.phi-=e}function i(e){N.object instanceof THREE.PerspectiveCamera?F/=e:N.object instanceof THREE.OrthographicCamera?(N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom*e)),N.object.updateProjectionMatrix(),Y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),N.enableZoom=!1)}function s(e){N.object instanceof THREE.PerspectiveCamera?F*=e:N.object instanceof THREE.OrthographicCamera?(N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom/e)),N.object.updateProjectionMatrix(),Y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),N.enableZoom=!1)}function c(e){B.set(e.clientX,e.clientY)}function u(e){Q.set(e.clientX,e.clientY)}function l(e){K.set(e.clientX,e.clientY)}function d(e){X.set(e.clientX,e.clientY),G.subVectors(X,B);var t=N.domElement===document?N.domElement.body:N.domElement;a(2*Math.PI*G.x/t.clientWidth*N.rotateSpeed),r(2*Math.PI*G.y/t.clientHeight*N.rotateSpeed),B.copy(X),N.update()}function m(e){J.set(e.clientX,e.clientY),$.subVectors(J,Q),$.y>0?i(o()):$.y<0&&s(o()),Q.copy(J),N.update()}function E(e){W.set(e.clientX,e.clientY),q.subVectors(W,K),ne(q.x,q.y),K.copy(W),N.update()}function f(e){}function p(e){e.deltaY<0?s(o()):e.deltaY>0&&i(o()),N.update()}function h(e){switch(e.keyCode){case N.keys.UP:ne(0,N.keyPanSpeed),N.update();break;case N.keys.BOTTOM:ne(0,-N.keyPanSpeed),N.update();break;case N.keys.LEFT:ne(N.keyPanSpeed,0),N.update();break;case N.keys.RIGHT:ne(-N.keyPanSpeed,0),N.update()}}function b(e){B.set(e.touches[0].pageX,e.touches[0].pageY)}function v(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+n*n);Q.set(0,o)}function T(e){K.set(e.touches[0].pageX,e.touches[0].pageY)}function R(e){X.set(e.touches[0].pageX,e.touches[0].pageY),G.subVectors(X,B);var t=N.domElement===document?N.domElement.body:N.domElement;a(2*Math.PI*G.x/t.clientWidth*N.rotateSpeed),r(2*Math.PI*G.y/t.clientHeight*N.rotateSpeed),B.copy(X),N.update()}function g(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+n*n);J.set(0,a),$.subVectors(J,Q),$.y>0?s(o()):$.y<0&&i(o()),Q.copy(J),N.update()}function w(e){W.set(e.touches[0].pageX,e.touches[0].pageY),q.subVectors(W,K),ne(q.x,q.y),K.copy(W),N.update()}function H(e){}function y(e){if(N.enabled!==!1){if(e.preventDefault(),e.button===N.mouseButtons.ORBIT){if(N.enableRotate===!1)return;c(e),k=U.ROTATE}else if(e.button===N.mouseButtons.ZOOM){if(N.enableZoom===!1)return;u(e),k=U.DOLLY}else if(e.button===N.mouseButtons.PAN){if(N.enablePan===!1)return;l(e),k=U.PAN}k!==U.NONE&&(document.addEventListener("mousemove",O,!1),document.addEventListener("mouseup",M,!1),N.dispatchEvent(D))}}function O(e){if(N.enabled!==!1)if(e.preventDefault(),k===U.ROTATE){if(N.enableRotate===!1)return;d(e)}else if(k===U.DOLLY){if(N.enableZoom===!1)return;m(e)}else if(k===U.PAN){if(N.enablePan===!1)return;E(e)}}function M(e){N.enabled!==!1&&(f(e),document.removeEventListener("mousemove",O,!1),document.removeEventListener("mouseup",M,!1),N.dispatchEvent(S),k=U.NONE)}function x(e){N.enabled===!1||N.enableZoom===!1||k!==U.NONE&&k!==U.ROTATE||(e.preventDefault(),e.stopPropagation(),p(e),N.dispatchEvent(D),N.dispatchEvent(S))}function A(e){N.enabled!==!1&&N.enableKeys!==!1&&N.enablePan!==!1&&h(e)}function P(e){if(N.enabled!==!1){switch(e.touches.length){case 1:if(N.enableRotate===!1)return;b(e),k=U.TOUCH_ROTATE;break;case 2:if(N.enableZoom===!1)return;v(e),k=U.TOUCH_DOLLY;break;case 3:if(N.enablePan===!1)return;T(e),k=U.TOUCH_PAN;break;default:k=U.NONE}k!==U.NONE&&N.dispatchEvent(D)}}function j(e){if(N.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(N.enableRotate===!1)return;if(k!==U.TOUCH_ROTATE)return;R(e);break;case 2:if(N.enableZoom===!1)return;if(k!==U.TOUCH_DOLLY)return;g(e);break;case 3:if(N.enablePan===!1)return;if(k!==U.TOUCH_PAN)return;w(e);break;default:k=U.NONE}}function C(e){N.enabled!==!1&&(H(e),N.dispatchEvent(S),k=U.NONE)}function L(e){e.preventDefault()}this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return V.phi},this.getAzimuthalAngle=function(){return V.theta},this.reset=function(){N.target.copy(N.target0),N.object.position.copy(N.position0),N.object.zoom=N.zoom0,N.object.updateProjectionMatrix(),N.dispatchEvent(I),N.update(),k=U.NONE},this.update=function(){var t=new THREE.Vector3,o=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),r=o.clone().inverse(),i=new THREE.Vector3,s=new THREE.Quaternion;return function(){var e=N.object.position;return t.copy(e).sub(N.target),t.applyQuaternion(o),V.setFromVector3(t),N.autoRotate&&k===U.NONE&&a(n()),V.theta+=z.theta,V.phi+=z.phi,V.theta=Math.max(N.minAzimuthAngle,Math.min(N.maxAzimuthAngle,V.theta)),V.phi=Math.max(N.minPolarAngle,Math.min(N.maxPolarAngle,V.phi)),V.makeSafe(),V.radius*=F,V.radius=Math.max(N.minDistance,Math.min(N.maxDistance,V.radius)),N.target.add(Z),t.setFromSpherical(V),t.applyQuaternion(r),e.copy(N.target).add(t),N.object.lookAt(N.target),N.enableDamping===!0?(z.theta*=1-N.dampingFactor,z.phi*=1-N.dampingFactor):z.set(0,0,0),F=1,Z.set(0,0,0),!!(Y||i.distanceToSquared(N.object.position)>_||8*(1-s.dot(N.object.quaternion))>_)&&(N.dispatchEvent(I),i.copy(N.object.position),s.copy(N.object.quaternion),Y=!1,!0)}}(),this.dispose=function(){N.domElement.removeEventListener("contextmenu",L,!1),N.domElement.removeEventListener("mousedown",y,!1),N.domElement.removeEventListener("wheel",x,!1),N.domElement.removeEventListener("touchstart",P,!1),N.domElement.removeEventListener("touchend",C,!1),N.domElement.removeEventListener("touchmove",j,!1),document.removeEventListener("mousemove",O,!1),document.removeEventListener("mouseup",M,!1),window.removeEventListener("keydown",A,!1)};var N=this,I={type:"change"},D={type:"start"},S={type:"end"},U={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},k=U.NONE,_=1e-6,V=new THREE.Spherical,z=new THREE.Spherical,F=1,Z=new THREE.Vector3,Y=!1,B=new THREE.Vector2,X=new THREE.Vector2,G=new THREE.Vector2,K=new THREE.Vector2,W=new THREE.Vector2,q=new THREE.Vector2,Q=new THREE.Vector2,J=new THREE.Vector2,$=new THREE.Vector2,ee=function(){var e=new THREE.Vector3;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),Z.add(e)}}(),te=function(){var e=new THREE.Vector3;return function(t,n){e.setFromMatrixColumn(n,1),e.multiplyScalar(t),Z.add(e)}}(),ne=function(){var e=new THREE.Vector3;return function(t,n){var o=N.domElement===document?N.domElement.body:N.domElement;if(N.object instanceof THREE.PerspectiveCamera){var a=N.object.position;e.copy(a).sub(N.target);var r=e.length();r*=Math.tan(N.object.fov/2*Math.PI/180),ee(2*t*r/o.clientHeight,N.object.matrix),te(2*n*r/o.clientHeight,N.object.matrix)}else N.object instanceof THREE.OrthographicCamera?(ee(t*(N.object.right-N.object.left)/N.object.zoom/o.clientWidth,N.object.matrix),te(n*(N.object.top-N.object.bottom)/N.object.zoom/o.clientHeight,N.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),N.enablePan=!1)}}();N.domElement.addEventListener("contextmenu",L,!1),N.domElement.addEventListener("mousedown",y,!1),N.domElement.addEventListener("wheel",x,!1),N.domElement.addEventListener("touchstart",P,!1),N.domElement.addEventListener("touchend",C,!1),N.domElement.addEventListener("touchmove",j,!1),window.addEventListener("keydown",A,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}})},47:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=n(48),i=o(r),s=n(49),c=o(s),u=1,l=function d(e){a(this,d);for(var t=[],n=[],o=[],r=0;r<e.length;r++)(e[r].isMain||e[r].isAttached)&&(t.push((e[r].x1+e[r].x2)/2,0,(e[r].y1+e[r].y2)/2),n.push(e[r].x2-e[r].x1,u,e[r].y2-e[r].y1),o.push(e[r].isMain?1:e[r].isAttached?2:0));var s=new THREE.BoxBufferGeometry(1,1,1),l=new THREE.InstancedBufferGeometry;l.addAttribute("position",s.attributes.position),l.addAttribute("normal",s.attributes.normal),l.setIndex(s.index),l.addAttribute("offset",new THREE.InstancedBufferAttribute(new Float32Array(t),3,1)),l.addAttribute("scale",new THREE.InstancedBufferAttribute(new Float32Array(n),3,1)),l.addAttribute("metaInfo",new THREE.InstancedBufferAttribute(new Float32Array(o),1,1));var m=THREE.UniformsUtils.clone(THREE.UniformsLib.lights),E=new THREE.RawShaderMaterial({uniforms:m,vertexShader:i["default"],fragmentShader:c["default"],side:THREE.DoubleSide,transparent:!1,lights:!0});return new THREE.Mesh(l,E)};t["default"]=l},48:function(e,t){e.exports="attribute vec3 position;\r\nattribute vec3 normal;\r\n\r\nattribute vec3 offset;\r\nattribute vec3 scale;\r\nattribute float metaInfo;\r\n\r\nuniform mat4 viewMatrix;\r\nuniform mat4 projectionMatrix;\r\n\r\nvarying vec3 vNormal;\r\nvarying float vIsMain;\r\n\r\nvoid main() {\r\n    mat4 modelMat = mat4(\r\n        scale.x, 0., 0., 0.,\r\n        0., scale.y, 0., 0.,\r\n        0., 0., scale.z, 0.,\r\n        offset.x, offset.y, offset.z, 1.\r\n    );\r\n\tgl_Position = projectionMatrix * viewMatrix * modelMat * vec4(position, 1.);\r\n\r\n\tvNormal = mat3(viewMatrix * modelMat) * normal;\r\n\tvIsMain = metaInfo;\r\n}\r\n"},49:function(e,t){e.exports="precision mediump float;\r\nvarying vec3 vNormal;\r\nvarying float vIsMain;\r\n\r\n#include <common>\r\n#include <lights_pars>\r\n\r\nvoid main() {\r\n\tvec3 light;\r\n\r\n\tvec3 c = (vIsMain < -0.5) ? vec3(0.8, 0.8, 0.8) : (vIsMain > 1.5) ? vec3(0.2, 0.5, 0.1) : (vIsMain > 0.5) ? vec3(0.6, 0., 0) : ambientLightColor;\r\n\t#if NUM_DIR_LIGHTS > 0\r\n\tfor (int i = 0; i < NUM_DIR_LIGHTS; i++) {\r\n\t\tlight = max( dot(normalize(vNormal), directionalLights[i].direction), 0.0) * directionalLights[i].color * 0.5;\r\n\t\tc += light;\r\n\t}\r\n\t#endif\r\n\r\n\tgl_FragColor = vec4(c, 1.0);\r\n}\r\n"},50:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=n(48),i=o(r),s=n(49),c=o(s),u=1.7,l=1.2,d=function m(e){a(this,m);for(var t=[],n=[],o=[],r=void 0,s=void 0,d=void 0,E=void 0,f=void 0,p=0;p<e.length;p+=4)r=e[p],d=e[p+1],s=e[p+2],E=e[p+3],t.push((r+s)/2,0,(d+E)/2),f=Math.abs(s-r)>Math.abs(E-d),n.push(f?Math.abs(s-r)+l/2:l,u,f?l:Math.abs(E-d)+l/2),o.push(-1);var h=new THREE.BoxBufferGeometry(1,1,1),b=new THREE.InstancedBufferGeometry;b.addAttribute("position",h.attributes.position),b.addAttribute("normal",h.attributes.normal),b.setIndex(h.index),b.addAttribute("offset",new THREE.InstancedBufferAttribute(new Float32Array(t),3,1)),b.addAttribute("scale",new THREE.InstancedBufferAttribute(new Float32Array(n),3,1)),b.addAttribute("metaInfo",new THREE.InstancedBufferAttribute(new Float32Array(o),1,1));var v=THREE.UniformsUtils.clone(THREE.UniformsLib.lights),T=new THREE.RawShaderMaterial({uniforms:v,vertexShader:i["default"],fragmentShader:c["default"],side:THREE.DoubleSide,transparent:!1,lights:!0});return new THREE.Mesh(b,T)};t["default"]=d},51:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function a(e,t){n(this,a);for(var o=new THREE.Object3D,r=new THREE.LineBasicMaterial({color:t}),i=0;i<e.length;i+=4){var s=new THREE.Geometry;s.vertices.push(new THREE.Vector3(e[i],1,e[i+1]),new THREE.Vector3(e[i+2],1,e[i+3]));var c=new THREE.Line(s,r);o.add(c)}return o};t["default"]=o}})});